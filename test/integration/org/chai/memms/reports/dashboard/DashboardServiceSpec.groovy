package org.chai.memms.reports.dashboard

import static org.junit.Assert.*

import grails.test.mixin.*
import grails.test.mixin.support.*
import org.junit.*
import org.chai.memms.IntegrationTests
import org.joda.time.DateTime



class DashboardServiceSpec  extends IntegrationTests{
def dashboardService
def indicatorComputationService
   def  "get Current Memms Report"() {
                setup:
                 setupLocationTree()
                 setupSystemUser()
                 setupEquipment()
                 createDashboardTestData()
                 indicatorComputationService.computeCurrentReport()
		when:
		 MemmsReport result = dashboardService.getCurrentMemmsReport()
                 DateTime now = DateTime.now()
               
                 def today= now.getDayOfWeek()
                 DateTime compareToThisDate = new DateTime(result.generatedAt)
                def compareToDay=compareToThisDate.getDayOfWeek()
		then:
                assert today==compareToDay
                 println" computation repport :"+result
                
        
    }
    
    
}
